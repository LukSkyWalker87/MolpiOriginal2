<!-- Estilos específicos para el componente productos (alineado con promociones) -->
<style>
.productos-component .table img { border-radius: 6px; }

/* Miniaturas más grandes como en promociones */
.productos-component .table td img {
  width: 150px;   /* 164px en XL */
  height: 90px;
  object-fit: cover;
  border: 1px solid #e9ecef;
}

.productos-component .badge { font-size: .85rem; }

.productos-component .btn-sm { margin-right: 3px; min-width: 88px; max-width: none; padding:.5rem .85rem; font-size:.95rem; }

.productos-component .modal-lg { max-width: 900px; }

.productos-component #vistaPrevia { border: 2px dashed #ddd; border-radius: 8px; }

.productos-component .card { box-shadow: 0 2px 4px rgba(0,0,0,0.08); border: 0; }

.productos-component .table-responsive { border-radius: 8px; }

/* Overrides – look & feel grande (match promociones + un poco más) */
.productos-component .card-body{ padding:1rem !important; }
.productos-component .btn-sm{ padding:.5rem .85rem; font-size:.95rem; }
.productos-component .table{ margin:0; font-size:1.08rem; }
.productos-component .table thead th{
  background:#f8f9fa; border-bottom:2px solid #dee2e6; color:#495057;
  font-weight:600; font-size:1.05rem; padding:.85rem 1rem; white-space:nowrap;
}
.productos-component .table td{
  padding:.85rem 1rem; vertical-align:middle; border-top:1px solid #eef1f4; white-space:nowrap;
}
.productos-component .table tbody tr:hover{ background:#f3f6fb; }
.productos-component .badge{ font-size:.8rem; padding:.45em .65em; }
.productos-component .acciones .btn{ min-width:108px; padding:.5rem .8rem; font-size:.95rem; }
@media (min-width:1200px){
  .productos-component .table{ font-size:1.12rem; }
  .productos-component .table thead th{ font-size:1.1rem; }
  .productos-component .table td img{ width:164px; height:98px; }
}

/* Asegurar modal-xl en el tema actual */
.modal-xl { max-width: 1140px; }

/* Ajustes de ancho de columna Acciones (última columna) */
.productos-component .table th:last-child,
.productos-component .table td:last-child { min-width: 200px; width: 240px; max-width: 280px; text-align: center; }



/* Rayado suave manteniendo hover agradable */
.productos-component .table-striped tbody tr:nth-of-type(odd){ background-color: rgba(0,0,0,.035); }

/* Estilos para modal minimalista y moderno */
.productos-component .modal-content {
  border: none;
  border-radius: 12px;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
}

.productos-component .modal-header {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 12px 12px 0 0;
  padding: 1.5rem 2rem;
}

.productos-component .modal-title {
  font-weight: 600;
  font-size: 1.25rem;
  display: flex;
  align-items: center;
}

.productos-component .modal-title i {
  margin-right: 0.75rem;
  font-size: 1.5rem;
  opacity: 0.9;
}

.productos-component .modal-header .close {
  color: white;
  opacity: 0.8;
  font-size: 1.5rem;
  text-shadow: none;
  padding: 0;
  background: none;
  border: none;
}

.productos-component .modal-header .close:hover {
  opacity: 1;
  color: white;
}

.productos-component .modal-body {
  padding: 2rem;
  background-color: #fafafa;
}

.productos-component .form-group {
  margin-bottom: 1.5rem;
}

.productos-component .form-group label {
  font-weight: 600;
  color: #4a5568;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
  font-size: 0.9rem;
}

.productos-component .form-group label i {
  margin-right: 0.5rem;
  color: #667eea;
  width: 16px;
  text-align: center;
}

.productos-component .form-control {
  border: 2px solid #e2e8f0;
  border-radius: 8px;
  padding: 0.75rem 1rem;
  transition: all 0.2s ease;
  background-color: white;
  font-size: 0.9rem;
}

.productos-component .form-control:focus {
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
  outline: none;
}

/* Estilos específicos para los filtros del admin */
.productos-component .card-body .form-control {
  font-size: 1.05rem !important;
  color: #2d3748 !important;
  background-color: white !important;
  border: 1px solid #d1d5db !important;
  height: 46px !important;
  line-height: 1.6 !important;
}

.productos-component .card-body .form-control option {
  color: #2d3748 !important;
  background-color: white !important;
  font-size: 0.85rem !important;
}

.productos-component .card-body .form-control-sm {
  padding: 0.65rem 1rem !important;
  font-size: 1.05rem !important;
  line-height: 1.6 !important;
  height: 46px !important;
  color: #374151 !important;
  background-color: #ffffff !important;
  border: 1px solid #d1d5db !important;
  border-radius: 6px !important;
}

.productos-component .card-body .form-control-sm:focus {
  border-color: #3b82f6 !important;
  box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1) !important;
}

.productos-component .form-control-file {
  padding: 0.5rem 0;
}

.productos-component .form-text {
  font-size: 0.95rem;
  color: #718096;
  margin-top: 0.25rem;
}

.productos-component .badge {
  padding: 0.5rem 0.75rem;
  border-radius: 6px;
  font-weight: 500;
}

.productos-component .modal-footer {
  padding: 1.5rem 2rem;
  border: none;
  background-color: #f7fafc;
  border-radius: 0 0 12px 12px;
}

.productos-component .btn { border-radius: 8px; padding: 0.6rem 1.2rem; font-weight: 500; transition: all 0.2s ease; }

.productos-component .btn-primary {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border: none;
}

.productos-component .btn-primary:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
}

.productos-component .btn-secondary {
  background-color: #e2e8f0;
  border: none;
  color: #4a5568;
}

.productos-component .btn-secondary:hover {
  background-color: #cbd5e0;
  color: #2d3748;
}

/* Sección de vista previa mejorada */
.productos-component #vistaPrevia {
  background: white;
  border: 2px dashed #e2e8f0;
  border-radius: 12px;
  padding: 1.5rem;
}

.productos-component .preview-section {
  background: white;
  border-radius: 8px;
  padding: 1rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.productos-component .preview-title {
  font-weight: 600;
  color: #4a5568;
  font-size: 0.9rem;
  margin-bottom: 0.75rem;
  display: flex;
  align-items: center;
}

.productos-component .preview-title i {
  margin-right: 0.5rem;
  color: #667eea;
}

/* Estados de archivo mejorados */
.productos-component .archivo-estado {
  background: #f0fff4;
  border: 1px solid #9ae6b4;
  border-radius: 6px;
  padding: 0.5rem 0.75rem;
  display: inline-flex;
  align-items: center;
  font-size: 0.8rem;
  color: #2f855a;
  margin-top: 0.5rem;
}

.productos-component .archivo-estado i {
  margin-right: 0.5rem;
}

/* Mejoras en los campos de grupo */
.productos-component .input-group {
  display: flex;
  align-items: center;
  background: white;
  border: 2px solid #e2e8f0;
  border-radius: 8px;
  padding: 0.75rem 1rem;
  transition: all 0.2s ease;
}

.productos-component .input-group:focus-within {
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.productos-component .input-group i {
  color: #a0aec0;
  margin-right: 0.75rem;
}
</style>

<!-- Contenido principal del componente -->
<div class="productos-component">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
          <h5 class="mb-0"><i class="fa fa-cube mr-2"></i>Gestión de Productos</h5>
          <button class="btn btn-success" id="btnNuevoProducto">
            <i class="fa fa-plus mr-1"></i>Nuevo Producto
          </button>
        </div>
        <div class="card-body" style="padding: 0.5rem;">
          <!-- Filtros rápidos por línea (OCULTOS) -->
          <div class="row mb-1" style="display: none;">
            <div class="col-12">
              <h6 class="text-muted mb-1" style="font-size: 0.8rem;">Filtros rápidos por línea:</h6>
              <div class="btn-group mr-2" role="group">
                <button type="button" class="btn btn-outline-primary btn-sm" id="filtroTodos">
                  <i class="fa fa-list mr-1"></i>Todos los productos
                </button>
                <button type="button" class="btn btn-outline-info btn-sm" id="filtro20x20">
                  <i class="fa fa-square mr-1"></i>Línea 20x20
                </button>
                <button type="button" class="btn btn-outline-warning btn-sm" id="filtro40x40">
                  <i class="fa fa-square mr-1"></i>Zócalos 40x40
                </button>
                <button type="button" class="btn btn-outline-success btn-sm" id="filtro50x50">
                  <i class="fa fa-square mr-1"></i>Zócalos 50x50
                </button>
                <button type="button" class="btn btn-outline-danger btn-sm" id="filtroPodotactiles">
                  <i class="fa fa-universal-access mr-1"></i>Podotáctiles - Discapacidad
                </button>
              </div>
            </div>
          </div>
          
          <!-- Filtros tradicionales -->
          <div class="row mb-1">
            <div class="col-md-3">
              <select class="form-control form-control-sm" id="filtroCategoria">
                <option value="">Todas las categorías</option>
              </select>
            </div>
            <div class="col-md-3">
              <select class="form-control form-control-sm" id="filtroSubcategoria">
                <option value="">Todas las subcategorías</option>
              </select>
            </div>
            <div class="col-md-6">
              <input type="text" class="form-control form-control-sm" id="buscarProducto" placeholder="Buscar productos...">
            </div>
          </div>
          
          <!-- Tabla de productos -->
          <div class="table-responsive" style="overflow-x: auto;">
            <table class="table table-striped">
              <thead>
        </div>
        <script src="/js/producto-guardado.js"></script>
      </form>
              <tbody id="tablaProductos">
                <tr>
                  <td colspan="9" class="text-center">
                    <div class="spinner-border" role="status">
                      <span class="sr-only">Cargando productos...</span>
                    </div>
                    <p class="mt-2">Cargando productos...</p>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal para crear/editar producto -->
<div class="modal fade" id="modalProducto" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalProductoTitle">
          <i class="fa fa-cube"></i>Nuevo Producto
        </h5>
        <button type="button" class="close" data-dismiss="modal">
          <span>&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form id="formProducto">
          <input type="hidden" id="productoId" name="id">
          
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="productoNombre">
                  <i class="fa fa-tag"></i> Nombre del Producto *
                </label>
                <input type="text" class="form-control" id="productoNombre" name="nombre" required 
                       placeholder="Ej: Adoquín Hexagonal 20x20">
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="productoCategoria">
                  <i class="fa fa-folder"></i> Categoría *
                </label>
                <select class="form-control" id="productoCategoria" name="categoria" required>
                  <option value="">Selecciona una categoría</option>
                </select>
                </div>
            </div>
          </div>
          
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="productoSubcategoria">
                  <i class="fa fa-tags"></i> Subcategoría *
                </label>
                <select class="form-control" id="productoSubcategoria" name="subcategoria" required>
                  <option value="">Selecciona una subcategoría</option>
                </select>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="productoEstado">
                  <i class="fa fa-toggle-on"></i> Estado
                </label>
                <select class="form-control" id="productoEstado" name="activo">
                  <option value="1">✅ Activo</option>
                  <option value="0">❌ Inactivo</option>
                </select>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label for="productoDescripcion">
              <i class="fa fa-align-left"></i> Descripción
            </label>
            <textarea class="form-control" id="productoDescripcion" name="descripcion" rows="3" 
                      placeholder="Describe las características principales del producto..."></textarea>
          </div>
          
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="productoImagen">
                  <i class="fa fa-image"></i> Imagen del Molde *
                </label>
                <input type="file" class="form-control-file" id="productoImagenFile" accept="image/*">
                <input type="text" class="form-control mt-2" id="productoImagen" name="imagen_url" 
                       placeholder="O ingrese la URL: img/products/molde.jpg">
                <small class="form-text">
                  <i class="fa fa-info-circle"></i> Suba una imagen o ingrese la URL. Formato: JPG/PNG
                </small>
                
                <!-- Estado del archivo de imagen del molde -->
                <div id="archivoEstadoMolde" class="archivo-estado" style="display: none;">
                  <i class="fa fa-check"></i> Imagen del molde seleccionada
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="productoImagenMosaico">
                  <i class="fa fa-picture-o"></i> Imagen del Mosaico (Opcional)
                </label>
                <input type="file" class="form-control-file" id="productoImagenMosaicoFile" accept="image/*">
                <input type="text" class="form-control mt-2" id="productoImagenMosaico" name="imagen_mosaico_url" 
                       placeholder="O ingrese la URL: img/products/mosaico.png">
                <small class="form-text">
                  <i class="fa fa-lightbulb-o"></i> Para mostrar el resultado final del cerámico
                </small>
                
                <!-- Estado del archivo de imagen del mosaico -->
                <div id="archivoEstadoMosaico" class="archivo-estado" style="display: none;">
                  <i class="fa fa-check"></i> Imagen del mosaico seleccionada
                </div>
              </div>
            </div>
          </div>
          
          <div class="row">
            <!-- Eliminado campo de URL del PDF -->
          </div>
          
          <!-- Vista previa de imagen -->
          <div class="form-group">
            <label class="preview-title">
              <i class="fa fa-eye"></i> Vista Previa de Imágenes
            </label>
            <div id="vistaPrevia" style="min-height: 350px;">
              
              <!-- Vista individual de cada imagen -->
              <div id="vistasIndividuales" style="display: none;">
                <div class="row">
                  <div class="col-md-6">
                    <div class="preview-section text-center">
                      <h6 class="preview-title">
                        <i class="fa fa-cube"></i>Molde
                      </h6>
                      <div style="min-height: 200px; display: flex; align-items: center; justify-content: center; border: 2px dashed #e2e8f0; border-radius: 8px;">
                        <img id="soloMolde" src="" alt="Solo molde" style="max-width: 150px; max-height: 150px; border-radius: 8px;">
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="preview-section text-center">
                      <h6 class="preview-title">
                        <i class="fa fa-picture-o"></i>Mosaico
                      </h6>
                      <div style="min-height: 200px; display: flex; align-items: center; justify-content: center; border: 2px dashed #e2e8f0; border-radius: 8px;">
                        <img id="soloMosaico" src="" alt="Solo mosaico" style="max-width: 150px; max-height: 150px; border-radius: 8px; display: none;">
                        <span id="sinMosaico" class="text-muted" style="font-size: 12px;">
                          <i class="fa fa-image text-muted"></i><br>Sin mosaico
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Mensaje cuando no hay imágenes -->
              <div id="sinImagen" class="text-center" style="padding: 100px 0;">
                <i class="fa fa-image text-muted" style="font-size: 48px; margin-bottom: 10px; opacity: 0.3;"></i>
                <p class="text-muted">Selecciona una imagen para ver la vista previa</p>
              </div>
            </div>
            <small class="form-text">
              <i class="fa fa-info-circle"></i>
              <strong>Molde:</strong> Imagen del molde de concreto | 
              <strong>Mosaico:</strong> Patrón cerámico que se superpone | 
              <strong>Resultado:</strong> Vista final del producto terminado
            </small>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">
          <i class="fa fa-times mr-1"></i>Cancelar
        </button>
        <button type="submit" class="btn btn-primary" form="formProducto">
          <i class="fa fa-save mr-1"></i>Guardar Producto
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Modal especial para editar textos descriptivos de podotáctiles -->
<div class="modal fade" id="modalEditarPodotactil" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">
          <i class="fa fa-universal-access mr-2"></i>Editar Producto Podotáctil
        </h5>
        <button type="button" class="close" data-dismiss="modal">
          <span>&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form id="formEditarPodotactil">
          <input type="hidden" id="podotactilId" name="id">
          
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="podotactilNombre">
                  <i class="fa fa-tag"></i>Nombre del Producto *
                </label>
                <input type="text" class="form-control" id="podotactilNombre" name="nombre" required
                       placeholder="Ej: Guía Podotáctil Recta">
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="podotactilCategoria">
                  <i class="fa fa-folder"></i>Categoría
                </label>
                <input type="text" class="form-control" id="podotactilCategoria" value="Podotáctiles" readonly style="background-color: #f8f9fa; border: 1px solid #e2e8f0;">
              </div>
            </div>
          </div>
          
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="podotactilSubcategoria">
                  <i class="fa fa-tags"></i>Subcategoría
                </label>
                <input type="text" class="form-control" id="podotactilSubcategoria" value="Discapacidad" readonly style="background-color: #f8f9fa; border: 1px solid #e2e8f0;">
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="podotactilActivo">
                  <i class="fa fa-toggle-on"></i>Estado
                </label>
                <select class="form-control" id="podotactilActivo" name="activo">
                  <option value="1">✅ Activo</option>
                  <option value="0">❌ Inactivo</option>
                </select>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label for="podotactilDescripcion">
              <i class="fa fa-align-left"></i>Descripción / Especificaciones
            </label>
            <textarea class="form-control" id="podotactilDescripcion" name="descripcion" rows="4" required 
                      placeholder="Escribe aquí las especificaciones y descripción del producto podotáctil..."></textarea>
            <small class="form-text">
              <i class="fa fa-info-circle"></i> Esta descripción se mostrará como información técnica del producto. Incluye características, usos y beneficios.
            </small>
          </div>
          
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="podotactilImagenMolde">
                  <i class="fa fa-image"></i>Imagen del Molde
                </label>
                <input type="file" class="form-control-file" id="podotactilImagenMoldeFile" accept="image/*">
                <input type="text" class="form-control mt-2" id="podotactilImagenMolde" name="imagen_url" 
                       placeholder="O ingrese la URL de la imagen del molde">
                <small class="form-text text-muted">Suba una imagen o ingrese la URL del molde</small>
                
                <!-- Estado del archivo de imagen del molde -->
                <div id="archivoEstadoMoldePodotactil" class="mt-2" style="display: none;">
                  <span class="badge badge-success">
                    <i class="fa fa-check"></i> Imagen del molde seleccionada
                  </span>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="podotactilImagenMosaico">Imagen del Mosaico</label>
                <input type="file" class="form-control-file" id="podotactilImagenMosaicoFile" accept="image/*">
                <input type="text" class="form-control mt-2" id="podotactilImagenMosaico" name="imagen_mosaico_url" 
                       placeholder="O ingrese la URL de la imagen del mosaico">
                <small class="form-text text-muted">Para mostrar el resultado final del cerámico sobre el molde</small>
                
                <!-- Estado del archivo de imagen del mosaico -->
                <div id="archivoEstadoMosaicoPodotactil" class="mt-2" style="display: none;">
                  <span class="badge badge-info">
                    <i class="fa fa-check"></i> Imagen del mosaico seleccionada
                  </span>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Vista previa de imagen -->
          <div class="form-group">
            <label class="preview-title">
              <i class="fa fa-eye"></i>Vista Previa de Imágenes
            </label>
            <div id="vistaPreviaPodotactil" style="min-height: 300px;">
              
              <!-- Vista individual de cada imagen -->
              <div id="vistasIndividualesPodotactil" style="display: none;">
                <div class="row">
                  <div class="col-md-6">
                    <div class="preview-section text-center">
                      <h6 class="preview-title">
                        <i class="fa fa-cube"></i>Molde
                      </h6>
                      <div style="min-height: 150px; display: flex; align-items: center; justify-content: center; border: 2px dashed #e2e8f0; border-radius: 8px;">
                        <img id="podotactilMoldeImg" src="" alt="Molde" style="max-width: 120px; max-height: 120px; border-radius: 8px;">
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="preview-section text-center">
                      <h6 class="preview-title">
                        <i class="fa fa-picture-o"></i>Mosaico
                      </h6>
                      <div style="min-height: 150px; display: flex; align-items: center; justify-content: center; border: 2px dashed #e2e8f0; border-radius: 8px;">
                        <img id="podotactilMosaicoImg" src="" alt="Mosaico" style="max-width: 120px; max-height: 120px; border-radius: 8px; display: none;">
                        <span id="sinMosaicoPodotactil" class="text-muted" style="font-size: 12px;">
                          <i class="fa fa-image text-muted"></i><br>Sin mosaico
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Mensaje cuando no hay imágenes -->
              <div id="sinImagenPodotactil" class="text-center" style="padding: 80px 0;">
                <i class="fa fa-image text-muted" style="font-size: 48px; margin-bottom: 10px; opacity: 0.3;"></i>
                <p class="text-muted">Selecciona una imagen para ver la vista previa</p>
              </div>
            </div>
            <small class="form-text">
              <i class="fa fa-info-circle"></i>
              <strong>Molde:</strong> Imagen del molde de concreto | 
              <strong>Mosaico:</strong> Patrón cerámico que se superpone
            </small>
          </div>
          
          <div class="alert alert-info">
            <h6><i class="fa fa-info-circle mr-1"></i>Información:</h6>
            <p class="mb-0">Los productos podotáctiles son elementos especializados para accesibilidad. Puedes modificar las imágenes cambiando las URLs arriba.</p>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">
          <i class="fa fa-times mr-1"></i>Cancelar
        </button>
        <button type="submit" class="btn btn-primary" form="formEditarPodotactil">
          <i class="fa fa-save mr-1"></i>Guardar Cambios
        </button>
      </div>
    </div>
  </div>
</div>
